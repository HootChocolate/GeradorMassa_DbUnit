package seuBarrigaPontoCom_estrategia4;

import static org.junit.Assert.assertNotNull;

import java.sql.Connection;
import java.sql.SQLException;

import org.junit.Before;
import org.junit.Test;

import br.ce.wcaquino.dao.utils.ConnectionFactory;
import br.ce.wcaquino.entidades.Usuario;
import br.ce.wcaquino.service.UsuarioService;

public class TestService_Usuario {

	private UsuarioService usuarioService = new UsuarioService();
	
	@Before
	public void setUp() throws Exception {
		
		Connection conexaoJDBC = ConnectionFactory.getConnection();
		
		conexaoJDBC.prepareStatement("WITH consulta AS (DELETE FROM contas) DELETE FROM usuarios").execute();
		
		ConnectionFactory.closeConnection();
	}
	
	@Test
	public void testInsercaoUsuario() throws Exception {
		Connection conexaoJDBC = ConnectionFactory.getConnection();
		
		conexaoJDBC.prepareStatement(""
				+ "INSERT INTO usuarios "
				+ "(id, nome, email, senha, conta_principal_id) "
				+ "VALUES (1, 'Usuario inserido', 'inserido@gmail.com)', '1234', 1)").execute();
		
		ConnectionFactory.closeConnection();
		
		Usuario usuario = usuarioService.findByNome("Usuario inserido");
		
		System.out.println(usuario);
		assertNotNull("[ERRO]Houve erro ao tentar inserir um usuario no banco de dados - TestService_Usuario", usuario);
		
	}
}
